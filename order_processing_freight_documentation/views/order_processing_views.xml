<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="order_processing_view_form" model="ir.ui.view">
        <field name="name">order.processing.form.freight.documentation</field>
        <field name="model">order.processing</field>
        <field name="inherit_id" ref="order_processing.order_processing_view_form"/>
        <field name="arch" type="xml">
            <xpath expr="//page[@name='other_info']" position="before">
                <page name="freight_documents" string="Freight &amp; Documents">
                    <header>
                        <button name="action_create_rfq_with_freight_documentation" string="Create RFQ" type="object"
                                class="oe_highlight"/>
                        <button name="action_create_quotation_with_freight_documentation" string="Create quotation" type="object"
                                class="oe_highlight"/>
                    </header>
                    <field name="freight_documentation_ids"
                           widget="section_and_note_one2many"
                           mode="tree">

                        <tree string="Sale Order Line" editable="bottom">
                            <control>
                                <create name="add_product_control" string="Add a product"/>
                                <!--                                        <create name="add_section_control" string="Add a section"-->
                                <!--                                                context="{'default_display_type': 'line_section'}"/>-->
                                <!--                                        <create name="add_note_control" string="Add a note"-->
                                <!--                                                context="{'default_display_type': 'line_note'}"/>-->
                            </control>
                            <field name="company_id" invisible="1"/>
                            <field name="sequence" widget="handle"/>
                            <field name="sequence_number"/>
                            <field name="product_id"/>
                            <field name="default_code"/>
                            <field name="name"/>
                            <field name="partner_id"/>
                            <field name="product_uom_qty"/>
                            <field name="product_uom" groups="uom.group_uom"/>
                            <field name="price_cost"/>
                            <field name="price_unit"/>
                            <field name="tax_id" widget="many2many_tags" options="{'no_create': True}"
                                   context="{'search_view_ref': 'account.account_tax_view_search'}"
                                   domain="[('company_id','=',parent.company_id)]"/>
                            <field name="price_subtotal_cost" widget="monetary"/>
                            <field name="price_subtotal_sale" widget="monetary"
                                   groups="account.group_show_line_subtotals_tax_excluded"/>
                        </tree>

                    </field>

                    <group class="oe_subtotal_footer oe_right" style="border-top:none!important;">
                        <div class="oe_inline o_td_label">
                            <h3>Purchase</h3>
                        </div>
                        <field name="amount_untaxed_freight_cost" widget="monetary" class="oe_subtotal_footer_separator"
                               options="{'currency_field': 'currency_id'}"/>
                        <field name="amount_tax_freight_cost" widget="monetary"
                               options="{'currency_field': 'currency_id'}"/>
                        <div class="oe_subtotal_footer_separator oe_inline">
                            <label for="amount_total_freight_cost"/>
                        </div>
                        <field name="amount_total_freight_cost" nolabel="1"
                               widget="monetary"
                               options="{'currency_field': 'currency_id'}"/>
                    </group>
                    <div class="oe_clear"/>

                    <group class="oe_subtotal_footer oe_right" colspan="2" name="sale_total"
                           style="border-top:none!important;">
                        <div class="oe_inline o_td_label">
                            <h3>Sales</h3>
                        </div>
                        <field name="amount_untaxed_freight_sale" widget='monetary'
                               options="{'currency_field': 'currency_id'}"/>
                        <field name="amount_tax_freight_sale" widget='monetary'
                               options="{'currency_field': 'currency_id'}"/>
                        <div class="oe_subtotal_footer_separator oe_inline o_td_label">
                            <label for="amount_total_freight_sale"/>
                        </div>
                        <field name="amount_total_freight_sale" nolabel="1" class="oe_subtotal_footer_separator"
                               widget='monetary'
                               options="{'currency_field': 'currency_id'}"/>
                    </group>
                    <div class="oe_clear"/>
                    <group class="oe_subtotal_footer oe_right" colspan="2" name="margin_total"
                           style="border-top:none!important;">
                        <div class="oe_inline o_td_label">
                            <h3>Margin</h3>
                        </div>
                        <div class="oe_clear"/>
                        <div class="oe_subtotal_footer_separator oe_inline o_td_label">
                            <label for="amount_total_margin"/>
                        </div>
                        <field name="amount_total_margin" nolabel="1" class="oe_subtotal_footer_separator"
                               widget='monetary'
                               options="{'currency_field': 'currency_id'}"/>
                    </group>
                </page>
            </xpath>
        </field>
    </record>
</odoo>